<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Pi+IoT+JS</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/night.css">

    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="lib/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Theme used for syntax highlighting of code -->
    <!-- <link rel="stylesheet" href="lib/css/zenburn.css"> -->
    <!-- <link rel="stylesheet" href="lib/css/darkula.css"> -->
    <link rel="stylesheet" href="lib/css/tomorrow-night-bright.css">
    <!-- <link rel="stylesheet" href="lib/css/xt256.css"> -->

    <!-- Printing and PDF exports -->
    <script>
     var link = document.createElement( 'link' );
     link.rel = 'stylesheet';
     link.type = 'text/css';
     link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
     document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
	<section>
	  <h1>Pi + JS = IoT</h1>
	  <p>
            <a href="https://github.com/idcrook/rpi-iot-demo-2017" target="_blank">https://github.com/idcrook/rpi-iot-demo-2017</a>
	    <br />
	    January 9, 2017
	  </p>
	  <p>
	    <i class="fa fa-twitter-square"> <a href="https://twitter.com/idcrook">@idcrook</a></i>
	    <i class="fa fa-github-square"> <a href="https://github.com/idcrook">@idcrook</a></i>
	    <br />
	    <i class="fa fa-envelope-square"> <a href="mailto:idcrook@idcrook.com">idcrook@idcrook.com</a></i>
	  </p>
	</section>

	<section>
	  <h2>Internet of Things</h2>

	  <blockquote cite="https://www.lifewire.com/funny-internet-quotes-3482759">
	    &ldquo;Oh, so they have internet on computers now!&rdquo; <b>~Homer Simpson</b>
	  </blockquote>

	  <p>The Internet of Things (abbreviated as "<b>IoT</b>") refers to ever-growing network of physical objects that feature an IP address and can communicate using the Internet.</p>

	  <p><b>Consumer Examples</b>: <a href="http://github.crookster.org/timetemp/charts/weekly/" target="_blank">Weather stations</a>, garage doors, baby monitors, Canary security system, Hue light bulbs, WeMo plugs, Nest thermostat, Amazon Echo ...</p>

	</section>

	<section>
	  <h2>Quiz Time</h2>

	  <blockquote >
	    <u>Question</u>: Does anyone know what the &ldquo;<b>S</b>&rdquo; in &ldquo;<b>IoT</b>&rdquo; stands for?<br />
	  </blockquote>

	  <blockquote class="fragment" data-fragment-index="0">
	    <u>Answer</u>: <b>S</b>ecurity.
	  </blockquote>

	</section>

	<section data-markdown>
	  <script type="text/template">
			      ## Javascript and IoT

			      **Node.js** is an excellent choice in IoT platforms

			       - low resource requirements, e.g. Raspberry Pi
			       - event-based I/O, data streams

			      Communications: HTTP, WebSockets, [MQTT](https://github.com/mqttjs/MQTT.js), [AMQP](https://www.rabbitmq.com/tutorials/tutorial-one-javascript.html)

   			      IoT Frameworks: [Node RED](https://developer.ibm.com/recipes/tutorials/deploy-watson-iot-node-on-raspberry-pi/), [Particle.io](https://docs.particle.io/guide/getting-started/intro/raspberry-pi/), [AWS IoT Device SDK](http://docs.aws.amazon.com/iot/latest/developerguide/iot-device-sdk-node.html)

			      Robotics: [Johnny Five](http://johnny-five.io/examples/raspi-io/), [Cylon.js](https://cylonjs.com/documentation/platforms/raspberry-pi/)
	  </script>
	</section>

	<section>
	  <h2>MQTT</h2>
	  <p><cite>'<a href="http://mqtt.org/" target="_blank">MQTT</a> is a machine-to-machine (M2M)/"Internet of Things" connectivity protocol.'</cite></p>
	  <ul>
	    <li>"<b>PubSub</b>" model with "Topics". Very simple.</li>
	    <li>Low resource requirements at endpoints</li>
	    <li>MQTT "Broker" server does most of the work</li>
	  </ul>
	  <p>For our demo:
	    <br />
	    MQTT Broker is using WebSockets and running on a Pi!</p>
	</section>

	<section>
	  <h2>Publish/Subscribe with Topics</h2>
	  <img src="img/Screen-Shot-2014-10-22-at-12.21.07-edited.png" />
	</section>

	<!-- Example of MQTT real-time temperature -->
	<section mqtt>
	  <h3>rpit5 Temperature:</h3>
	  <p>rpit5 connected ->
	    <span style="color: #fff000">
              iot-demo/rpit5/connected
            </span>
	  </p>
	  <h4>CPU:
            <span style="color: #fff000">
              iot-demo/rpit5/raspi/cputemp
            </span> °C
	  </h4>
	  <h4>GPU:
            <span style="color: #fff000">
              iot-demo/rpit5/raspi/gputemp
            </span> °C
	  </h4>
	  <p>
	    If MQTT streaming is:
	    <ul>
	      <li> <b>working:</b> <a href="http://rpit5.local:3000" target="_blank">live temperatures</a> will be displayed above.</li>
	      <li> <b>disabled:</b> just the topic paths will be displayed, like<pre>iot-demo/rpit5/raspi/cputemp</pre></li>
	    </ul>
	  </p>
	</section>

	<section>
	  <h2>Raspberry Pi</h2>
	  <p>Raspberry Pi example of a SBC (Single Board Computer)</p>
	  <ul>
	    <li>run complete, modern operating systems</li>
	    <li>small, low-power, low-cost form factors</li>
	    <li>include full assortment of connectivity</li>
	  </ul>
	  <table>
	    <thead>
	      <tr>
		<th>SBC</th>
		<th>Price</th>
	      </tr>
	    </thead>
	    <tbody>
	      <tr>
		<td>RasPi 3 (built-in WiFi, BT)</td>
		<td>$35</td>
	      </tr>
	      <tr>
		<td>RasPi Model B (Clearance)</td>
		<td>$12</td>
	      </tr>
	      <tr>
		<td>Raspberry Pi Zero</td>
		<td>$5</td>
	      </tr>
	      <!-- <tr>
		   <td>Particle <a href="https://www.particle.io/products/hardware/electron-cellular-dev-kit">(Cellular)</a></td>
		   <td><a href="https://store.particle.io/products/photon" target="_blank">$19</a>-<a href="https://store.particle.io/products/electron-2g" target="_blank">$49</a></td>
		   </tr> -->
	      <tr>
		<td>Many more exist</td>
		<td>...</td>
	      </tr>
	    </tbody>
	  </table>
	</section>

	<section>
	  <h2>Pieces of Pi</h2>
	  <p>Raspberry Pi models "B+" or "2" in front of you
	    <ul>
	      <li>Running <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian (Linux)</a> on µSD card</li>
	      <ul>
		<li>5 W power supply (cell-phone charger)</li>
		<li>Wired Ethernet cable</li>
	      </ul>
	      <li>Pi also talks with onboard 40-pin header</li>
	      <ul>
		<li>"breadboard" makes wiring easier</li>
		<li><em>We'll use some of these pins today!</em></li>
	      </ul>
	    </ul>
	  </p>
	</section>

	<section>
	  <h2>Demo Preview</h2>
	  <ol>
	    <li>Network and power up Pi</li>
	    <li>Chart live-streaming data on webpage</li>
	    <li>Wire LEDs to Pi and program</li>
	  </ol>
	  <p>Each Pi shares data using MQTT</p>
	</section>

	<section>
	  <h2>Demo Requirements</h2>

	  <ul>
	    <li>Laptop or Smartphone having</li>
	    <ul>
	      <li>Wi-Fi</li>
	      <li>SSH client</li>
	      <li>Web browser</li>
	    </ul>
	    <li>Can share among groups</li>
	  </ul>
	  <ul>
	    Each station has
	    <li>Networked and Powered Pi</li>
	    <ul>
	      <li>"Pi Pad" mount</li>
	      <li>Components</li>
	      <li>Wires and Breadboard</li>
	    </ul>
	  </ul>
	</section>

	<section>

	  <section>
	    <h3>Running client</h3>
	    <p>
	      <ol>
		<li>Connect to Wi-Fi</li>
		<li>SSH into Pi</li>
		username: <b>pi</b>
		<br />password: <b>raspberry</b>
		<li>Start node.js, using commands:</li>
	      </ol>
	    </p>
	    <h2><pre>cd iot-demo/client</pre></h2>
	    <h2><pre>screen -R</pre></h2>
	    <h2><pre>   &lt;Enter&gt;</pre></h2>
	    <h2><pre>node index.js</pre></h2>
	    Temperature chart: <a href="http://example.com:3000/">http://name.local:3000</a>
	  </section>

	  <section>
	    <h2>Client output</h2>
	    <img src="img/rpit5_StartingClient.png" />
	  </section>

	  <section>
	    <h3>SSH to Pi</h3>
	    Username: <b><code>pi</code></b>
	    <br />Password: <b><code>raspberry</code></b>
	    <table>
	      <thead>
		<tr>
		  <th>Name</th>
		  <th>IP Address</th>
		</tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><code>rpit3</code></td>
		  <td><code>192.168.8.23</code></td>
		</tr>
		<tr>
		  <td><code>rpit4</code></td>
		  <td><code>192.168.8.24</code></td>
		</tr>
		<tr>
		  <td><code>rpip5</code></td>
		  <td><code>192.168.8.25</code></td>
		</tr>
		<tr>
		  <td><code>rpip6</code></td>
		  <td><code>192.168.8.26</code></td>
		</tr>
		<tr>
		  <td><code>rpip7</code></td>
		  <td><code>192.168.8.27</code></td>
		</tr>
		<tr>
		  <td><code>rpip8</code></td>
		  <td><code>192.168.8.28</code></td>
		</tr>
		<tr>
		  <td><code>rpip9</code></td>
		  <td><code>192.168.8.29</code></td>
		</tr>
		<tr>
		  <td><code>rpip10</code></td>
		  <td><code>192.168.8.30</code></td>
		</tr>
	      </tbody>
	    </table>
	    Zeroconf also works: <code><b>&lt;name&gt;.local</b></code>
	  </section>
	</section>


	<section>
	  <h2>Live Dashboard</h2>
	  <p><a href="http://rpit5.local:3000/dashboard.html" target="_blank">Live Dashboard, Served from a Pi</a>
	    <br />(MQTT + WebSockets + SVG + Javascript)</p>

	    <img src="https://raw.githubusercontent.com/idcrook/rpi-iot-demo-2017/master/info/RasPi_IoT_Dashboard_animation.gif" />

	</section>

	<section>
	  <h2>Button and LEDs</h2>
	  <p>Switch presses and LEDs are handled using <a href="https://github.com/fivdi/onoff" target="_blank">onoff</a> library.</p>
	  <pre><code class"lang-javascript" data-trim data-noescape>
var button = new Gpio(button_Gpio, 'in', 'both', {debounceTimeout: 20});
var redLed = new Gpio(redLed_Gpio, 'low');
var buttonPressedCount = 0;

button.watch(function (err, value) {
  if (value === 0) {
    console.log('BUTTON PRESSED!');
    // implement a toggle based on button presses
    buttonPressedCount += 1;
    if (buttonPressedCount % 2) {
      client.publish(pubRedLed, 'on', {qos: 1, retain: true});
      redLed.writeSync(1); // 1 = on, 0 = off
    } else {
      client.publish(pubRedLed, 'off', {qos: 1, retain: true});
      redLed.writeSync(0); // 1 = on, 0 = off
    }
  }
}
	  </code></pre>
	</section>

	<section data-background="img/XXvnnrJJnOVl6.gif"> <!-- "http://i.giphy.com/XXvnnrJJnOVl6.gif" -->
	  <h1>Watch it light up</h1>
	</section>

	<section>
	  <section>
	  <h4>Wiring Diagram</h4>
	  <img src="img/Wire_BB_Main.png" />
	  <img src="img/Wire_BB_Switch1.png" />
	  </section>

	  <section>
	    <h4>Wiring Diagram w/ Debounce</h4>
	    <img src="img/Wire_BB_Main.png" />
	    <img src="img/Wire_BB_Switch2.png" />
	  </section>
	</section>

	<section data-background="img/InternetOfRansomwareThings.png">
	  &nbsp;
	</section>


      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
     // More info https://github.com/hakimel/reveal.js#configuration
     Reveal.initialize({
       history: true,

       mqtt_broker: 'rpit5.local', // Broker address
       mqtt_port: '9001', // MQTT over Web Socket port
       mqtt_username: 'pi', // username [optional]
       mqtt_password: 'raspberry', // username [optional]

       // More info https://github.com/hakimel/reveal.js#dependencies
       dependencies: [
	 { src: 'plugin/markdown/marked.js' },
	 { src: 'plugin/markdown/markdown.js' },
	 { src: 'plugin/notes/notes.js', async: true },
         //add THIS dependencies for MQTT plugin
         { src: 'plugin/mqtt/mqtt/mqttws31.js', async: true },
	 { src: 'plugin/mqtt/mqtt/mqtt.js', async: true },
	 { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
       ]
     });
    </script>
  </body>
</html>
